pipeline{
    agent any
        parameters {
            string(name: 'IMAGETAG', defaultValue: '1.0.52') // multiple assignments
        }
    stages{

        // stage("Fetch code"){

        // }
        stage("Build & push"){
            steps{
                script{
                    // This step should not normally be used in your script. Consult the inline help for details.
                        withDockerRegistry(credentialsId: 'dockerhub_id') {
                            sh "docker build -t myapp:${params.IMAGETAG} ."
                            sh "docker tag myapp:${params.IMAGETAG} jesusgeo/myapp:${params.IMAGETAG}"
                            sh "docker push jesusgeo/myapp:${params.IMAGETAG}"
                        }
                }
                
            }
           
        }
    }
    
}


